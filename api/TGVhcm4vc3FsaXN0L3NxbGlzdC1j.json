{"title":"sqlist.c","date":"2024-03-12T12:16:00.000Z","date_formatted":{"ll":"2024年3月12日","L":"2024/03/12","MM-DD":"03-12"},"updated":"2024-03-12T12:17:55.670Z","content":"<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#include &lt;stdio.h&gt;</span><br><span class=\"line\">#include &lt;stdlib.h&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">#include &quot;sqlist.h&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">sqlist *sqlist_create () &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    sqlist *me;</span><br><span class=\"line\"></span><br><span class=\"line\">    me = malloc (sizeof (*me));</span><br><span class=\"line\">    // me 表示指针，*me 表示取值，即结构体的值，这里获取结构体的大小,将分配 *me 大小的空间的首地址赋给 me.     </span><br><span class=\"line\">    if (me == NULL)</span><br><span class=\"line\">        return NULL;</span><br><span class=\"line\">    me -&gt; last = -1;</span><br><span class=\"line\"></span><br><span class=\"line\">    return me;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;  </span><br><span class=\"line\"></span><br><span class=\"line\">// 或采用二级指针返回一个指针       </span><br><span class=\"line\">void sqlist_create1 (sqlist **ptr) &#123;</span><br><span class=\"line\">    *ptr = malloc (sizeof (**ptr));</span><br><span class=\"line\">    // 同样，sizeof 里面要对应结构体的大小，因为要创造一个结构体保存数组，二级指针获取结构体就是 **ptr, </span><br><span class=\"line\">    // 这样才是取最终结构体的值</span><br><span class=\"line\">    if (*ptr == NULL)</span><br><span class=\"line\">        return ;</span><br><span class=\"line\">    </span><br><span class=\"line\">    (*ptr) -&gt; last = -1;</span><br><span class=\"line\">    return ;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// datatype 这里不太适合传数据过来，即传值，因为你不知道datatype 为什么类型，</span><br><span class=\"line\">// 是 int 还是结构体,如果是结构体，显然你直接传值是不对的,因为你又不是把整个</span><br><span class=\"line\">// 结构体赋给它,而是把它里面的数据给它正确的应该为传变量的地址。</span><br><span class=\"line\">// i 的位置来做插入。</span><br><span class=\"line\">int sqlist_insert (sqlist *me, int i, datatype *data) &#123;</span><br><span class=\"line\">    int j;</span><br><span class=\"line\"></span><br><span class=\"line\">    if (me -&gt; last == DATASIZE - 1)</span><br><span class=\"line\">        return -1;</span><br><span class=\"line\"></span><br><span class=\"line\">    // 保证 i 值合法，因为存储的位置为连续存储，且 元素个数为 1 时，last 为 0，</span><br><span class=\"line\">    // 为了让 last 与 下标对应，所以最后一个值不是 last - 1, 而是就是 last;</span><br><span class=\"line\">    if(i &lt; 0 || i &gt; me -&gt;last + 1)</span><br><span class=\"line\">        return -2;</span><br><span class=\"line\"></span><br><span class=\"line\">    for (j = me -&gt; last; j &gt;= i; j--)</span><br><span class=\"line\">        me -&gt; data[j + 1] = me -&gt; data[j];</span><br><span class=\"line\"></span><br><span class=\"line\">    me -&gt; data[i] = *data;</span><br><span class=\"line\">    me -&gt; last++;</span><br><span class=\"line\">    </span><br><span class=\"line\">    return 0;       // 程序一般 0 表示正常，非 0 表示异常终止</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;   </span><br><span class=\"line\"></span><br><span class=\"line\">int sqlist_delete (sqlist *me, int i) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    int j;</span><br><span class=\"line\"></span><br><span class=\"line\">    if (i &lt; 0 || i &gt; me -&gt; last)</span><br><span class=\"line\">        return -1;</span><br><span class=\"line\">    </span><br><span class=\"line\">    for (j = i + 1; j &lt;= me -&gt; last; j++)&#123;</span><br><span class=\"line\">        me -&gt; data[j - 1] = me -&gt; data[j];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    me -&gt; last--;</span><br><span class=\"line\"></span><br><span class=\"line\">    return 0;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">int sqlist_find (sqlist *me, datatype *data) &#123;</span><br><span class=\"line\">    int i;</span><br><span class=\"line\"></span><br><span class=\"line\">    if (sqlist_isempty (me) == 0)</span><br><span class=\"line\">        return -1;  // 为空返回 -1;</span><br><span class=\"line\"></span><br><span class=\"line\">    for (i = 0; i &lt;= me -&gt; last; i++) &#123;</span><br><span class=\"line\">        if (me -&gt; data[i] == *data)&#123;</span><br><span class=\"line\">            return i;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    return -2;  // 不为空，但找不到，返回 -2;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">int sqlist_isempty (sqlist *me) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    if (me -&gt; last == -1)</span><br><span class=\"line\">        return 0;</span><br><span class=\"line\">    else</span><br><span class=\"line\">        return -1;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">int sqlist_setempty (sqlist *me) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    me -&gt; last = -1;</span><br><span class=\"line\">    return 0;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">int sqlist_getnum (sqlist *me) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    // 当数组元素为空时，me -&gt; last == -1;且 last 是从 0 开始的，所以当返回数组个数时只需 last + 1 即可 </span><br><span class=\"line\">    return (me -&gt; last + 1);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">void sqlist_display (sqlist *me) &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    int i;</span><br><span class=\"line\">    if (me -&gt; last == -1)</span><br><span class=\"line\">        return ;</span><br><span class=\"line\"></span><br><span class=\"line\">    for (i = 0; i &lt;= me -&gt; last; i++)</span><br><span class=\"line\">        printf (&quot;%d &quot;, me -&gt; data[i]);</span><br><span class=\"line\">    printf (&quot;\\n&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    return ;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">int sqlist_destroy (sqlist *me) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    free (me);</span><br><span class=\"line\">    return 0;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">int sqlist_union (sqlist *list1, sqlist *list2) &#123;</span><br><span class=\"line\">    // list1 -&gt; 12, 23, 34, 45, 56;</span><br><span class=\"line\">    // list2 -&gt; 78, 89, 56, 23, 10;</span><br><span class=\"line\"></span><br><span class=\"line\">    int i = 0;</span><br><span class=\"line\"></span><br><span class=\"line\">    for (i = 0; i &lt;= list2 -&gt; last; i++) &#123;</span><br><span class=\"line\">        if (sqlist_find (list1, &amp;(list2 -&gt; data[i])) &lt; 0) &#123;</span><br><span class=\"line\">            sqlist_insert (list1, 0, &amp;(list2 -&gt; data[i]));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    return 0;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","link":"Learn/sqlist/sqlist-c","comments":true,"plink":"https://CHONG589.github.io/Learn/sqlist/sqlist-c/","reward":true,"copyright":{"published":"2024年3月12日","updated":"2024年3月12日","author":"Chong","link":"<a href=\"https://CHONG589.github.io/Learn/sqlist/sqlist-c/\" title=\"sqlist.c\">https://CHONG589.github.io/Learn/sqlist/sqlist-c/</a>","license":"Attribution-NonCommercial-NoDerivatives 4.0 International (<a href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/\" rel=\"external nofollow noopener\" target=\"_blank\">CC BY-NC-ND 4.0</a>)"}}